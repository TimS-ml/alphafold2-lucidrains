"""
AlphaFold2 常量定义

本模块包含 AlphaFold2 模型所需的所有常量，包括：
- 模型架构参数
- 预训练模型配置
- 氨基酸拓扑数据
"""

import torch

# constants - 模型架构常量

MAX_NUM_MSA = 20  # 最大 MSA 序列数量
MAX_NUM_TEMPLATES = 10  # 最大模板结构数量
NUM_AMINO_ACIDS = 21  # 氨基酸类型数量（20种标准氨基酸 + 1个填充/未知token）
NUM_EMBEDDS_TR = 1280  # ProtTrans/ESM 嵌入维度（最佳 ESM 模型）
NUM_EMBEDDS_T5 = 1024  # T5 嵌入维度（最佳 T5 模型）
NUM_COORDS_PER_RES = 14  # 每个残基的原子坐标数量

# 预测任务的分桶数量（用于分类任务）
DISTOGRAM_BUCKETS = 37  # 距离图的距离分桶数（用于残基间距离预测）
THETA_BUCKETS = 25  # θ 二面角的分桶数
PHI_BUCKETS = 13  # φ 二面角的分桶数
OMEGA_BUCKETS = 25  # ω 二面角的分桶数

# embedding related constants - 预训练模型相关常量

# ESM MSA Transformer 模型
MSA_EMBED_DIM = 768
MSA_MODEL_PATH = ["facebookresearch/esm", "esm_msa1_t12_100M_UR50S"]

# ESM-1b 单序列模型
ESM_EMBED_DIM = 1280
ESM_MODEL_PATH = ["facebookresearch/esm", "esm1b_t33_650M_UR50S"]

# ProtTrans 模型
PROTTRAN_EMBED_DIM = 1024

# default device - 默认设备

DEVICE_NAME = 'cuda' if torch.cuda.is_available() else 'cpu'
DEVICE = torch.device(DEVICE_NAME)

# aminoacid data - 氨基酸拓扑数据

# 20种标准氨基酸的原子间键连接信息
# 每个氨基酸包含其侧链原子之间的共价键索引对
# 用于构建蛋白质的图结构表示

AA_DATA = {
    'A': {  # 丙氨酸 (Alanine) - 最简单的侧链
        'bonds': [[0,1], [1,2], [2,3], [1,4]]
         },
    'R': {  # 精氨酸 (Arginine) - 带正电荷的长侧链
        'bonds': [[0,1], [1,2], [2,3], [2,4], [4,5], [5,6],
                  [6,7], [7,8], [8,9], [8,10]]
         },
    'N': {  # 天冬酰胺 (Asparagine) - 极性侧链
        'bonds': [[0,1], [1,2], [2,3], [1,4], [4,5], [5,6],
                  [5,7]]
         },
    'D': {  # 天冬氨酸 (Aspartic acid) - 带负电荷
        'bonds': [[0,1], [1,2], [2,3], [1,4], [4,5], [5,6],
                  [5,7]]
         },
    'C': {  # 半胱氨酸 (Cysteine) - 含硫，可形成二硫键
        'bonds': [[0,1], [1,2], [2,3], [1,4], [4,5]]
        },
    'Q': {  # 谷氨酰胺 (Glutamine) - 极性侧链
        'bonds': [[0,1], [1,2], [2,3], [1,4], [4,5], [5,6],
                  [6,7], [6,8]]
        },
    'E': {  # 谷氨酸 (Glutamic acid) - 带负电荷
        'bonds': [[0,1], [1,2], [2,3], [1,4], [4,5], [5,6],
                  [6,7], [7,8]]
        },
    'G': {  # 甘氨酸 (Glycine) - 最小的氨基酸
        'bonds': [[0,1], [1,2], [2,3]]
        },
    'H': {  # 组氨酸 (Histidine) - 咪唑侧链，可带电荷
        'bonds': [[0,1], [1,2], [2,3], [1,4], [4,5], [5,6],
                  [6,7], [7,8], [8,9], [5,9]]
        },
    'I': {  # 异亮氨酸 (Isoleucine) - 疏水性支链
        'bonds': [[0,1], [1,2], [2,3], [1,4], [4,5], [5,6],
                  [4,7]]
         },
    'L': {  # 亮氨酸 (Leucine) - 疏水性支链
        'bonds': [[0,1], [1,2], [2,3], [1,4], [4,5], [5,6],
                  [5,7]]
         },
    'K': {  # 赖氨酸 (Lysine) - 带正电荷的长侧链
        'bonds': [[0,1], [1,2], [2,3], [1,4], [4,5], [5,6],
                  [6,7], [7,8]]
         },
    'M': {  # 甲硫氨酸 (Methionine) - 含硫的疏水侧链
        'bonds': [[0,1], [1,2], [2,3], [1,4], [4,5], [5,6],
                  [6,7]]
         },
    'F': {  # 苯丙氨酸 (Phenylalanine) - 芳香族疏水侧链
        'bonds': [[0,1], [1,2], [2,3], [1,4], [4,5], [5,6],
                  [6,7], [7,8], [8,9], [9,10], [5,10]]
         },
    'P': {  # 脯氨酸 (Proline) - 环状结构，限制主链灵活性
        'bonds': [[0,1], [1,2], [2,3], [1,4], [4,5], [5,6],
                  [0,6]]
         },
    'S': {  # 丝氨酸 (Serine) - 含羟基的极性侧链
        'bonds': [[0,1], [1,2], [2,3], [1,4], [4,5]]
         },
    'T': {  # 苏氨酸 (Threonine) - 含羟基的极性侧链
        'bonds': [[0,1], [1,2], [2,3], [1,4], [4,5], [4,6]]
         },
    'W': {  # 色氨酸 (Tryptophan) - 最大的芳香族侧链
        'bonds': [[0,1], [1,2], [2,3], [1,4], [4,5], [5,6],
                  [6,7], [7,8], [8,9], [9,10], [10,11], [11,12],
                  [12, 13], [5,13], [8,13]]
         },
    'Y': {  # 酪氨酸 (Tyrosine) - 芳香族侧链，含羟基
        'bonds': [[0,1], [1,2], [2,3], [1,4], [4,5], [5,6],
                  [6,7], [7,8], [8,9], [8,10], [10,11], [5,11]]
         },
    'V': {  # 缬氨酸 (Valine) - 疏水性支链
        'bonds': [[0,1], [1,2], [2,3], [1,4], [4,5], [4,6]]
         },
    '_': {  # 占位符/未知氨基酸
        'bonds': []
        }
    }
